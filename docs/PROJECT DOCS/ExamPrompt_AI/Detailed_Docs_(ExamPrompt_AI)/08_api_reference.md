# API Reference

This document details the backend API endpoints exposed by ExamPrompt AI, built using Flask. It includes routes for file upload, chat interaction, chat history management, and debugging.

---

## Base URL

[http://localhost:7860/](http://localhost:7860/)

````

> This will vary based on your environment (`PORT` from `.env`).

---

## Endpoints

### `GET /`

**Returns**: The HTML homepage (for browser interface).

---

### `POST /upload`

**Purpose**: Uploads a PDF file, processes it into chunks, creates embeddings, and stores vectorized data.

#### Request:
- Content-Type: `multipart/form-data`
- Form fields:
  - `file`: PDF file
  - `user_id` (optional): If not provided, a new UUID is generated

#### Example:
```bash
curl -X POST http://localhost:7860/upload \
  -F "file=@sample.pdf" \
  -F "user_id=user123"
````

#### Response:

```json
{
  "success": true,
  "message": "Successfully processed sample.pdf",
  "filename": "sample.pdf",
  "user_id": "user123"
}
```

---

### `POST /chat`

**Purpose**: Accepts a user message and returns a response generated by Groq LLM using embedded document context.

#### Request:

* Content-Type: `application/json`
* JSON body:

```json
{
  "user_id": "user123",
  "message": "What is the conclusion of the document?"
}
```

#### Response:

```json
{
  "success": true,
  "user_message": "What is the conclusion of the document?",
  "response": "The document concludes by stating that..."
}
```

---

### `POST /clear_chat`

**Purpose**: Clears chat history for the given user.

#### Request:

```json
{
  "user_id": "user123"
}
```

#### Response:

```json
{
  "success": true,
  "message": "Chat history cleared"
}
```

---

### `POST /get_chat_history`

**Purpose**: Retrieves the chat history for a given user, excluding system messages.

#### Request:

```json
{
  "user_id": "user123"
}
```

#### Response:

```json
{
  "chat_history": [
    {"type": "user", "content": "What is the abstract about?"},
    {"type": "ai", "content": "The abstract discusses..."}
  ]
}
```

---

### `POST /debug_user`

**Purpose**: Returns metadata about the current userâ€™s document and chat status.

#### Request:

```json
{
  "user_id": "user123"
}
```

#### Response:

```json
{
  "success": true,
  "user_id": "user123",
  "document_processed": true,
  "has_vectorstore": true,
  "chat_history_length": 5,
  "filename": "sample.pdf"
}
```

---

## Error Handling

All routes return:

```json
{
  "success": false,
  "message": "Detailed error message"
}
```

---

## Notes

* All user data is stored via `pickle` and `base64` in local JSON or file-based storage (as assumed by `save_user_data()`).
* Each upload and chat session is linked via `user_id`.
* Memory and temp file cleanup is performed automatically using `gc` and `tempfile`.

---

## Future Additions

* `/summarize`: Summarize uploaded content
* `/compare`: Multi-file context Q\&A
* `/auth`: Firebase or OAuth integration
* `/session/save` & `/session/load`: Persist chat states across sessions

